(this["webpackJsonpchat-lite"]=this["webpackJsonpchat-lite"]||[]).push([[0],{44:function(e,a,t){e.exports=t(92)},88:function(e,a){},91:function(e,a,t){},92:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(41),s=t.n(c),u=t(7),o=t.n(u),l=t(11),m=t(4),i=t(13),E=t.n(i),p=t(42),d=t.n(p)()(),f=t(43),b=t(3),O=function(e,a){switch(a.type){case"JOINED":return Object(b.a)(Object(b.a)({},e),{},{joined:!0,userName:a.payload.userName,roomId:a.payload.roomId});case"SET_DATA":return Object(b.a)(Object(b.a)({},e),{},{users:a.payload.users,messages:a.payload.messages});case"SET_USERS":return Object(b.a)(Object(b.a)({},e),{},{users:a.payload});case"NEW_MESSAGE":return Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(f.a)(e.messages),[a.payload])});default:return e}};var v=function(e){var a=e.onLogin,t=r.a.useState(""),n=Object(m.a)(t,2),c=n[0],s=n[1],u=r.a.useState(""),i=Object(m.a)(u,2),p=i[0],d=i[1],f=r.a.useState(!1),b=Object(m.a)(f,2),O=b[0],v=b[1],N=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&p){e.next=2;break}return e.abrupt("return",alert("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"));case 2:return t={roomId:c,userName:p},v(!0),e.next=6,E.a.post("/rooms",t);case 6:a(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"join-block"},r.a.createElement("input",{type:"text",placeholder:"Room ID",value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:p,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{disabled:O,onClick:N,className:"btn btn-success"},O?"\u0412\u0425\u041e\u0414...":"\u0412\u041e\u0419\u0422\u0418"))};var N=function(e){var a=e.users,t=e.messages,n=e.userName,c=e.roomId,s=e.onAddMessage,u=r.a.useState(""),o=Object(m.a)(u,2),l=o[0],i=o[1],E=r.a.useRef(null);return r.a.useEffect((function(){E.current.scrollTo(0,99999)}),[t]),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat-users"},"\u041a\u043e\u043c\u043d\u0430\u0442\u0430: ",r.a.createElement("b",null,c),r.a.createElement("hr",null),r.a.createElement("b",null,"\u041e\u043d\u043b\u0430\u0439\u043d (",a.length,"):"),r.a.createElement("ul",null,a.map((function(e,a){return r.a.createElement("li",{key:e+a},e)})))),r.a.createElement("div",{className:"chat-messages"},r.a.createElement("div",{ref:E,className:"messages"},t.map((function(e){return r.a.createElement("div",{className:"message"},r.a.createElement("p",null,e.text),r.a.createElement("div",null,r.a.createElement("span",null,e.userName)))}))),r.a.createElement("form",null,r.a.createElement("textarea",{value:l,onChange:function(e){return i(e.target.value)},className:"form-control",rows:"3"}),r.a.createElement("button",{onClick:function(){d.emit("ROOM:NEW_MESSAGE",{userName:n,roomId:c,text:l}),s({userName:n,text:l}),i("")},type:"button",className:"btn btn-primary"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))))};var S=function(){var e=r.a.useReducer(O,{joined:!1,roomId:null,userName:null,users:[],messages:[]}),a=Object(m.a)(e,2),t=a[0],n=a[1],c=function(){var e=Object(l.a)(o.a.mark((function e(a){var t,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"JOINED",payload:a}),d.emit("ROOM:JOIN",a),e.next=4,E.a.get("/rooms/".concat(a.roomId));case 4:t=e.sent,r=t.data,n({type:"SET_DATA",payload:r});case 7:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),s=function(e){n({type:"SET_USERS",payload:e})},u=function(e){n({type:"NEW_MESSAGE",payload:e})};return r.a.useEffect((function(){d.on("ROOM:SET_USERS",s),d.on("ROOM:NEW_MESSAGE",u)}),[]),window.socket=d,r.a.createElement("div",{className:"wrapper"},t.joined?r.a.createElement(N,Object.assign({},t,{onAddMessage:u})):r.a.createElement(v,{onLogin:c}))};t(91);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.21e9a0cf.chunk.js.map